(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{OpKh:function(e,t,r){"use strict";r.r(t),r.d(t,"AuthenticationModule",(function(){return V}));var s=r("iInd"),i=r("SVse"),n=r("G0yt"),o=r("AytR");class a{constructor(){this.baseUrl=o.a.base_url,this.admin_login=this.baseUrl+"/api/auth/signin",this.registration=this.baseUrl+"/api/auth/signup"}}var c=r("JIr8"),l=r("z6cu"),b=r("8Y7J"),u=r("IheW");let d=(()=>{class e{constructor(e,t){this.http=e,this.endpoints=t}checkCredentials(e){return this.http.post(this.endpoints.admin_login,e).pipe(Object(c.a)(this.handleError))}registration(e){return this.http.post(this.endpoints.registration,e).pipe(Object(c.a)(this.handleError))}getAllCustomers(){}handleError(e){return Object(l.a)(e)}}return e.\u0275fac=function(t){return new(t||e)(b.ac(u.b),b.ac(a))},e.\u0275prov=b.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var g=r("s7LF"),h=r("TSSN");let f=(()=>{class e{}return e.\u0275mod=b.Lb({type:e}),e.\u0275inj=b.Kb({factory:function(t){return new(t||e)},imports:[[i.c,h.b]]}),e})();var m=r("XNiG"),p=r("pLZG");class v{constructor(e){Object.assign(this,e)}}var S=function(e){return e[e.Success=0]="Success",e[e.Error=1]="Error",e[e.Info=2]="Info",e[e.Warning=3]="Warning",e}({});let R=(()=>{class e{constructor(){this.subject=new m.a,this.defaultId="default-alert"}onAlert(e=this.defaultId){return this.subject.asObservable().pipe(Object(p.a)(t=>t&&t.id===e))}success(e,t){this.alert(new v(Object.assign(Object.assign({},t),{type:S.Success,message:e})))}error(e,t){this.alert(new v(Object.assign(Object.assign({},t),{type:S.Error,message:e})))}info(e,t){this.alert(new v(Object.assign(Object.assign({},t),{type:S.Info,message:e})))}warn(e,t){this.alert(new v(Object.assign(Object.assign({},t),{type:S.Warning,message:e})))}alert(e){e.id=e.id||this.defaultId,this.subject.next(e)}clear(e=this.defaultId){this.subject.next(new v({id:e}))}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275prov=b.Jb({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var w=r("vHPH"),A=r("7g+E");function C(e,t){if(1&e){const e=b.Tb();b.Sb(0,"div"),b.Sb(1,"a",1),b.dc("click",(function(){b.vc(e);const r=t.$implicit;return b.fc().removeAlert(r)})),b.Fc(2,"\xd7"),b.Rb(),b.Ob(3,"p",2),b.gc(4,"translate"),b.Rb()}if(2&e){const e=t.$implicit,r=b.fc();b.Cb(r.cssClass(e)),b.Ab(3),b.lc("innerHTML",b.hc(4,4,e.message),b.wc)}}let I=(()=>{class e{constructor(e,t,r){this.router=e,this.alertService=t,this.translate=r,this.id="default-alert",this.fade=!0,this.alerts=[],r.addLangs(["us","fr"]),r.setDefaultLang(localStorage.getItem("selected_lang"))}ngOnInit(){this.alertSubscription=this.alertService.onAlert(this.id).subscribe(e=>{if(!e.message)return this.alerts=this.alerts.filter(e=>e.keepAfterRouteChange),void this.alerts.forEach(e=>delete e.keepAfterRouteChange);this.alerts.push(e),e.autoClose&&setTimeout(()=>this.removeAlert(e),3e3)}),this.routeSubscription=this.router.events.subscribe(e=>{e instanceof s.b&&this.alertService.clear(this.id)})}ngOnDestroy(){this.alertSubscription.unsubscribe(),this.routeSubscription.unsubscribe()}removeAlert(e){this.alerts.includes(e)&&(this.fade?(this.alerts.find(t=>t===e).fade=!0,setTimeout(()=>{this.alerts=this.alerts.filter(t=>t!==e)},250)):this.alerts=this.alerts.filter(t=>t!==e))}cssClass(e){if(!e)return;const t=["alert","alert-dismissable"];return t.push({[S.Success]:"alert alert-success",[S.Error]:"alert alert-danger",[S.Info]:"alert alert-info",[S.Warning]:"alert alert-warning"}[e.type]),e.fade&&t.push("fade"),t.join(" ")}}return e.\u0275fac=function(t){return new(t||e)(b.Nb(s.c),b.Nb(R),b.Nb(h.d))},e.\u0275cmp=b.Hb({type:e,selectors:[["alert"]],inputs:{id:"id",fade:"fade"},decls:1,vars:1,consts:[[3,"class",4,"ngFor","ngForOf"],[1,"close",3,"click"],[2,"text-align","center",3,"innerHTML"]],template:function(e,t){1&e&&b.Dc(0,C,5,6,"div",0),2&e&&b.lc("ngForOf",t.alerts)},directives:[i.l],pipes:[h.c],encapsulation:2}),e})();function y(e,t){1&e&&(b.Sb(0,"div"),b.Fc(1,"Username is required"),b.Rb())}function O(e,t){if(1&e&&(b.Sb(0,"div",25),b.Dc(1,y,2,0,"div",26),b.Rb()),2&e){const e=b.fc();b.Ab(1),b.lc("ngIf",e.fields.username.errors.required)}}function F(e,t){1&e&&(b.Sb(0,"div"),b.Fc(1,"Pass is required"),b.Rb())}function x(e,t){if(1&e&&(b.Sb(0,"div",25),b.Dc(1,F,2,0,"div",26),b.Rb()),2&e){const e=b.fc();b.Ab(1),b.lc("ngIf",e.fields.password.errors.required)}}const k=function(e){return{"d-none":e}},q=function(e){return{"is-invalid":e}};let N=(()=>{class e{constructor(e,t,r,s,i,n,o,a){this.getData=e,this.formBuilder=t,this.spinner=r,this.alertService=s,this.router=i,this.route=n,this.translate=o,this.loggerService=a,this.options={autoClose:!0,keepAfterRouteChange:!1},this.submitted=!1,this.loginform=!0,this.recoverform=!1,o.addLangs(["us","fr"]),o.setDefaultLang(localStorage.getItem("selected_lang"))}ngOnInit(){this.loginData=this.formBuilder.group({username:["",[g.o.required]],password:["",[g.o.required]]}),this.returnUrl=this.route.snapshot.queryParams.returnUrl||"search-bus"}get fields(){return this.loginData.controls}ngAfterViewInit(){"true"===this.route.snapshot.queryParams.verified&&this.alertService.success("succ_email_verified",{autoClose:!0}),"false"===this.route.snapshot.queryParams.verified&&this.alertService.error("err_email_verify_expired",{autoClose:!0})}showRecoverForm(){this.loginform=!this.loginform,this.recoverform=!this.recoverform}showLoginForm(){this.loginform=!this.loginform,this.recoverform=!this.recoverform}doLogin(){this.spinner.show(),this.submitted=!0,this.loginData.invalid?this.spinner.hide():this.getData.checkCredentials(this.loginData.value).subscribe(e=>{"403"===e.code?(this.spinner.hide(),this.alertService.error("err_not_active",{autoClose:!0})):(this.spinner.hide(),this.loggerService.log("response",e),localStorage.setItem("user_token",e.accessToken),localStorage.setItem("user_id",e.id),localStorage.setItem("user_name",e.username),localStorage.setItem("user_username",e.username),this.router.navigate([this.returnUrl]))},e=>{this.spinner.hide(),this.loggerService.log("error",e.status),this.alertService.error(401===e.status?"err_invalid_cred":"err_common",{autoClose:!0})})}}return e.\u0275fac=function(t){return new(t||e)(b.Nb(d),b.Nb(g.b),b.Nb(A.c),b.Nb(R),b.Nb(s.c),b.Nb(s.a),b.Nb(h.d),b.Nb(w.a))},e.\u0275cmp=b.Hb({type:e,selectors:[["app-login"]],decls:42,vars:27,consts:[[1,"auth-wrapper","d-flex","no-block","justify-content-center","align-items-center",2,"background","url(assets/images/background/bg-001.jpg) no-repeat","background-size","cover","background-position","center"],[1,"auth-box","on-sidebar",2,"max-width","500px !important"],["id","loginform",3,"ngClass"],[1,"logo"],[1,"font-medium","m-b-20","text-base","font-weight-bold"],["fade","true"],[1,"row"],[1,"col-12"],[1,"form-horizontal","m-t-20",3,"formGroup","ngSubmit"],[1,"input-group","mb-3"],[1,"input-group-prepend"],["id","basic-addon1",1,"input-group-text"],[1,"ti-user"],["type","text","formControlName","username","name","username","placeholder","Username",1,"form-control","form-control-lg",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["id","basic-addon2",1,"input-group-text"],[1,"ti-lock"],["type","password","formControlName","password","name","password",1,"form-control","form-control-lg",3,"placeholder","ngClass"],[1,"form-group","text-center"],[1,"col-xs-12","p-b-5"],["type","submit",1,"btn","btn-block","btn-md","btn-rounded","btn-default","text-white","font-weight-bold"],[1,"form-group","m-b-0","m-t-5"],[1,"col-sm-12","text-center"],["href","#/authentication/signup",1,"text-info","m-l-5"],["href","#/search-bus","type","button",1,"btn","btn-block","btn-md","btn-rounded","btn-danger","text-white","font-weight-bold"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(e,t){1&e&&(b.Sb(0,"div",0),b.Sb(1,"div",1),b.Sb(2,"div",2),b.Sb(3,"div",3),b.Sb(4,"h2",4),b.Fc(5),b.gc(6,"translate"),b.Rb(),b.Rb(),b.Ob(7,"alert",5),b.Sb(8,"div",6),b.Sb(9,"div",7),b.Sb(10,"form",8),b.dc("ngSubmit",(function(){return t.doLogin()})),b.Sb(11,"div",9),b.Sb(12,"div",10),b.Sb(13,"span",11),b.Ob(14,"i",12),b.Rb(),b.Rb(),b.Ob(15,"input",13),b.Rb(),b.Dc(16,O,2,1,"div",14),b.Sb(17,"div",9),b.Sb(18,"div",10),b.Sb(19,"span",15),b.Ob(20,"i",16),b.Rb(),b.Rb(),b.Ob(21,"input",17),b.gc(22,"translate"),b.Dc(23,x,2,1,"div",14),b.Rb(),b.Sb(24,"div",18),b.Sb(25,"div",19),b.Sb(26,"button",20),b.Fc(27),b.gc(28,"translate"),b.Rb(),b.Rb(),b.Rb(),b.Sb(29,"div",21),b.Sb(30,"div",22),b.Fc(31),b.gc(32,"translate"),b.Sb(33,"a",23),b.Sb(34,"b"),b.Fc(35),b.gc(36,"translate"),b.Rb(),b.Rb(),b.Rb(),b.Rb(),b.Ob(37,"hr"),b.Sb(38,"div",18),b.Sb(39,"div",19),b.Sb(40,"a",24),b.Fc(41," Continue as Guest "),b.Rb(),b.Rb(),b.Rb(),b.Rb(),b.Rb(),b.Rb(),b.Rb(),b.Rb(),b.Rb()),2&e&&(b.Ab(2),b.lc("ngClass",b.oc(21,k,t.recoverform)),b.Ab(3),b.Gc(b.hc(6,11,"welcome_login")),b.Ab(5),b.lc("formGroup",t.loginData),b.Ab(5),b.lc("ngClass",b.oc(23,q,t.submitted&&t.fields.username.errors)),b.Ab(1),b.lc("ngIf",t.submitted&&t.fields.username.errors),b.Ab(5),b.mc("placeholder",b.hc(22,13,"password")),b.lc("ngClass",b.oc(25,q,t.submitted&&t.fields.password.errors)),b.Ab(2),b.lc("ngIf",t.submitted&&t.fields.password.errors),b.Ab(4),b.Hc(" ",b.hc(28,15,"login")," "),b.Ab(4),b.Hc(" ",b.hc(32,17,"no_account")," "),b.Ab(4),b.Gc(b.hc(36,19,"signup")))},directives:[i.k,I,g.q,g.i,g.d,g.a,g.h,g.c,i.m],pipes:[h.c],encapsulation:2}),e})();class _{}function D(e,t){1&e&&(b.Sb(0,"div"),b.Fc(1,"Name is required"),b.Rb())}function j(e,t){if(1&e&&(b.Sb(0,"div",28),b.Dc(1,D,2,0,"div",29),b.Rb()),2&e){const e=b.fc();b.Ab(1),b.lc("ngIf",e.fields.name.errors.required)}}function L(e,t){1&e&&(b.Sb(0,"div"),b.Fc(1,"Email is required"),b.Rb())}function G(e,t){if(1&e&&(b.Sb(0,"div",28),b.Dc(1,L,2,0,"div",29),b.Rb()),2&e){const e=b.fc();b.Ab(1),b.lc("ngIf",e.fields.email.errors.required)}}function E(e,t){1&e&&(b.Sb(0,"div"),b.Fc(1,"Username is required"),b.Rb())}function H(e,t){if(1&e&&(b.Sb(0,"div",28),b.Dc(1,E,2,0,"div",29),b.Rb()),2&e){const e=b.fc();b.Ab(1),b.lc("ngIf",e.fields.username.errors.required)}}function B(e,t){1&e&&(b.Sb(0,"div"),b.Fc(1,"Valid Pass is Required"),b.Rb())}function U(e,t){if(1&e&&(b.Sb(0,"div",28),b.Dc(1,B,2,0,"div",29),b.Rb()),2&e){const e=b.fc();b.Ab(1),b.lc("ngIf",e.fields.password.errors.required)}}const T=function(e){return{"d-none":e}},J=function(e){return{"is-invalid":e}},P=function(e){return{"d-block":e}},z=[{path:"",children:[{path:"login",component:N},{path:"signup",component:(()=>{class e{constructor(e,t,r,s,i,n,o,a){this.apiManagerService=e,this.formBuilder=t,this.spinner=r,this.alertService=s,this.router=i,this.registrationRequestBody=n,this.translate=o,this.loggerService=a,this.options={autoClose:!0,keepAfterRouteChange:!1},this.submitted=!1,this.signupFormShow=!1,o.addLangs(["us","fr"]),o.setDefaultLang(localStorage.getItem("selected_lang"))}ngOnInit(){this.registerForm=this.formBuilder.group({name:["",g.o.required],username:["",g.o.required],email:["",g.o.required],password:["",g.o.required]})}ngAfterViewInit(){}get fields(){return this.registerForm.controls}doRegistration(){if(this.spinner.show(),this.submitted=!0,this.registerForm.invalid)return this.spinner.hide(),void this.loggerService.log("registerForm",this.registerForm);this.registrationRequestBody=this.registerForm.getRawValue(),this.registrationRequestBody.role=["user"],console.log("registrationRequestBody",this.registrationRequestBody),this.apiManagerService.registration(this.registrationRequestBody).subscribe(e=>{this.spinner.hide(),this.loggerService.log("response",e),this.router.navigate(["authentication/login"])},e=>{this.spinner.hide(),this.loggerService.log("error",e),this.alertService.error(e.error.message,{autoClose:!0})})}}return e.\u0275fac=function(t){return new(t||e)(b.Nb(d),b.Nb(g.b),b.Nb(A.c),b.Nb(R),b.Nb(s.c),b.Nb(_),b.Nb(h.d),b.Nb(w.a))},e.\u0275cmp=b.Hb({type:e,selectors:[["app-signup"]],decls:54,vars:44,consts:[["fullScreen","false"],[2,"font-size","20px","color","white"],[1,"auth-wrapper","d-flex","no-block","justify-content-center","align-items-center"],[1,"auth-box",2,"max-width","500px"],["id","signupForm",3,"ngClass"],[1,"logo"],[1,"font-medium","m-b-20","text-base","font-weight-bold"],["fade","true"],[1,"row"],[1,"col-12"],[1,"form-horizontal","m-t-20",3,"formGroup","ngSubmit"],[1,""],["type","text","name","name","formControlName","name","placeholder","Name",1,"form-control","form-control-lg","text-base",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["type","email","formControlName","email","placeholder","Email*",1,"form-control","form-control-lg",3,"ngClass"],["type","text","formControlName","username","placeholder","Username*",1,"form-control","form-control-lg",3,"ngClass"],["type","password","formControlName","password",1,"form-control","form-control-lg",3,"placeholder","ngClass"],[1,"form-group","text-center"],[1,"col-xs-12"],["type","submit ",1,"btn","btn-block","btn-md","btn-rounded","btn-default","text-white","font-weight-bold"],[1,"form-group","m-b-0"],[1,"col-sm-12","text-center"],["href","#/authentication/login",1,"text-info","m-l-5"],["id","recoverform",3,"ngClass"],[1,"db"],["src","../../../../assets/images/logo.png","alt","logo",2,"max-width","40%"],[1,"font-medium","m-b-20","text-success"],["href","#/authentication/login"],[1,"invalid-feedback"],[4,"ngIf"]],template:function(e,t){1&e&&(b.Sb(0,"ngx-spinner",0),b.Sb(1,"p",1),b.Fc(2,"Loading..."),b.Rb(),b.Rb(),b.Sb(3,"div",2),b.Sb(4,"div",3),b.Sb(5,"div",4),b.Sb(6,"div",5),b.Sb(7,"h2",6),b.Fc(8),b.gc(9,"translate"),b.Rb(),b.Rb(),b.Ob(10,"alert",7),b.Sb(11,"div",8),b.Sb(12,"div",9),b.Sb(13,"form",10),b.dc("ngSubmit",(function(){return t.doRegistration()})),b.Sb(14,"div",11),b.Ob(15,"input",12),b.Dc(16,j,2,1,"div",13),b.Rb(),b.Ob(17,"br"),b.Sb(18,"div",11),b.Ob(19,"input",14),b.Dc(20,G,2,1,"div",13),b.Rb(),b.Ob(21,"br"),b.Sb(22,"div",11),b.Ob(23,"input",15),b.Dc(24,H,2,1,"div",13),b.Rb(),b.Ob(25,"br"),b.Sb(26,"div",11),b.Ob(27,"input",16),b.gc(28,"translate"),b.Dc(29,U,2,1,"div",13),b.Rb(),b.Ob(30,"br"),b.Sb(31,"div",17),b.Sb(32,"div",18),b.Sb(33,"button",19),b.Fc(34),b.gc(35,"translate"),b.Rb(),b.Rb(),b.Rb(),b.Sb(36,"div",20),b.Sb(37,"div",21),b.Fc(38),b.gc(39,"translate"),b.Sb(40,"a",22),b.Sb(41,"b"),b.Fc(42),b.gc(43,"translate"),b.Rb(),b.Rb(),b.Rb(),b.Rb(),b.Rb(),b.Rb(),b.Rb(),b.Rb(),b.Sb(44,"div",23),b.Sb(45,"div",5),b.Sb(46,"span",24),b.Ob(47,"img",25),b.Rb(),b.Sb(48,"h2",26),b.Fc(49),b.gc(50,"translate"),b.Rb(),b.Sb(51,"a",27),b.Fc(52),b.gc(53,"translate"),b.Rb(),b.Rb(),b.Rb(),b.Rb(),b.Rb()),2&e&&(b.Ab(5),b.lc("ngClass",b.oc(32,T,t.signupFormShow)),b.Ab(3),b.Gc(b.hc(9,18,"welcome_signup")),b.Ab(5),b.lc("formGroup",t.registerForm),b.Ab(2),b.lc("ngClass",b.oc(34,J,t.submitted&&t.fields.name.errors)),b.Ab(1),b.lc("ngIf",t.submitted&&t.fields.name.errors),b.Ab(3),b.lc("ngClass",b.oc(36,J,t.submitted&&t.fields.email.errors)),b.Ab(1),b.lc("ngIf",t.submitted&&t.fields.email.errors),b.Ab(3),b.lc("ngClass",b.oc(38,J,t.submitted&&t.fields.username.errors)),b.Ab(1),b.lc("ngIf",t.submitted&&t.fields.username.errors),b.Ab(3),b.nc("placeholder","",b.hc(28,20,"password"),"*"),b.lc("ngClass",b.oc(40,J,t.submitted&&t.fields.password.errors)),b.Ab(2),b.lc("ngIf",t.submitted&&t.fields.password.errors),b.Ab(5),b.Hc(" ",b.hc(35,22,"signup")," "),b.Ab(4),b.Hc(" ",b.hc(39,24,"yes_account"),"? "),b.Ab(4),b.Gc(b.hc(43,26,"login")),b.Ab(2),b.lc("ngClass",b.oc(42,P,t.signupFormShow)),b.Ab(5),b.Gc(b.hc(50,28,"congrats")),b.Ab(3),b.Gc(b.hc(53,30,"succ_signup_verification")))},directives:[A.a,i.k,I,g.q,g.i,g.d,g.a,g.h,g.c,i.m],pipes:[h.c],encapsulation:2}),e})()}]}];var M=r("ZAI4");let V=(()=>{class e{}return e.\u0275mod=b.Lb({type:e}),e.\u0275inj=b.Kb({factory:function(t){return new(t||e)},providers:[a,d,_],imports:[[i.c,s.f.forChild(z),n.h,g.e,g.n,A.b,f,h.b.forRoot({loader:{provide:h.a,useFactory:M.b,deps:[u.b]}})]]}),e})()}}]);